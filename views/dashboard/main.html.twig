{% extends '@pulsar/pulsar/layouts/dashboard.html.twig' %}
{% import '@pulsar/pulsar/helpers/html.html.twig' as html %}
{% import '@pulsar/pulsar/helpers/form.html.twig' as form %}
{% import '@pulsar/pulsar/helpers/flash.html.twig' as flash %}
{% import '@pulsar/pulsar/helpers/pulsar.html.twig' as pulsar %}

{% block title %}{{ parent() }}{% endblock %}

{% set heading = 'My Dashboard' %}

{% 
  set actions_menu = [
    html.link(
      label = html.icon('plus') ~ ' Create dashboard', 
      href = '#save'
    ),
    html.link(
      label = html.icon('save') ~ ' Save', 
      href = '#save', 
      attributes = 'data-action=save'
    ),
    html.link(
      label = html.icon('edit') ~ ' Rename', 
      href = '#rename', 
      attributes = 'data-toggle=modal data-target=#rename'
    ),
    html.divider(),
    html.link(
      label = html.icon('trash') ~ ' Delete', 
      href = '#delete', 
      class = 'link--danger',
      attributes = 'data-toggle=modal data-target=#delete'
    )
  ]
%}

{% block summary %}
  <div id="tray" class="tray">
  {% include '@pulsar/pulsar/components/widget_list.html.twig' %}
  <input type="hidden" id="widget__data" />
  </div>
{% endblock %}

{% block actionsbar %}
  {{ 
  html.button_group([
    html.button(
    label = html.icon('dashboard') ~ ' Widgets', 
    href = '#', 
    type = 'link', 
    attributes = 'data-toggle=tray data-target=#tray')
  ])
  }}
{% endblock %}

{% block widgets %}
{% endblock %}

{% block modals %}
<div id="rename" class="modal" role="dialog" aria-labelledby="rename-modal-title" aria-hidden="true">
  <div class="modal__dialog">
    <div class="modal__content">
      <div class="modal__header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 id="rename-modal-title" class="modal__title">Rename Dashboard</h4>
      </div>
      <div class="modal__body">
        {{ form.create(action = '#dashboard-rename', attributes = 'data-action=rename') }}
        {{ form.text(label = 'Name', name = "name", class = 'form__group--full', value = 'My Dashboard') }}
      </div>
      <div class="modal__footer">
        <button type="button" class="btn" data-dismiss="modal">Cancel</button>
        {{ form.submit(label = 'Save Changes', class = 'btn--primary') }}
        </form>
      </div>
    </div>
  </div>
</div>

<div id="delete" class="modal modal--danger" role="dialog" aria-labelledby="delete-modal-title" aria-hidden="true">
  <div class="modal__dialog">
    <div class="modal__content">
      <div class="modal__header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 id="delete-modal-title" class="modal__title">{{ html.icon('warning-sign') }} Delete &lsquo;<span id="dashboard-title">{{ heading }}</span>&rsquo;?</h4>
      </div>
      <div class="modal__body">
        Are you sure you would like to delete this dashboard and its settings?
      </div>
      <div class="modal__footer">
        <button type="button" class="btn" data-dismiss="modal">Don't Do Anything</button>
        {{ form.submit(label = 'Delete', class = 'btn--danger') }}
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block javascript %}
  <script id="dashboard-state" type="application/json">{{ initial_state|raw }}</script>
{% endblock %}